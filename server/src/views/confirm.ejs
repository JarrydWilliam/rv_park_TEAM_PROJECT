<!doctype html>
<html lang="en">
  <head>
    <%- include('partials/head') %>
    <title>Reservation Confirmed · RV Park</title>
  </head>
  <body>
    <%- include('partials/nav') %>

    <header class="page-hero">
      <div class="container">
        <h1 class="display-6 fw-semibold mb-1">Reservation Confirmed</h1>
        <p class="text-muted mb-0">
          Confirmation code: <strong><%= r.confirmationCode %></strong>
        </p>
      </div>
    </header>
<% if (typeof siteChanged !== 'undefined' && siteChanged) { %>
  <div class="alert alert-warning mt-3">
    <strong>Notice:</strong> Your reservation was moved to a different site to accommodate your new dates.
  </div>
<% } %>
<% if (typeof adjustment !== 'undefined' && adjustment && adjustment.amount > 0) { %>
  <div class="alert alert-info mt-3">
    <% if (adjustment.type === 'refund') { %>
      Your updated stay now costs
      <strong>$<%= Number(r.amountPaid).toFixed(2) %></strong>.
      You will be refunded
      <strong>$<%= adjustment.amount.toFixed(2) %></strong>.
    <% } else if (adjustment.type === 'additional') { %>
      Your updated stay now costs
      <strong>$<%= Number(r.amountPaid).toFixed(2) %></strong>.
      You owe an additional
      <strong>$<%= adjustment.amount.toFixed(2) %></strong>.
    <% } %>
  </div>
<% } %>

    <main class="container py-4">
      <section class="card card-elevated">
        <div class="card-body">
          <h2 class="h5 mb-3">Stay details</h2>

          <dl class="row mb-0">
            <dt class="col-sm-3">Guest</dt>
            <dd class="col-sm-9"><%= r.guestName %> &lt;<%= r.guestEmail %>&gt;</dd>

            <dt class="col-sm-3">Site</dt>
            <dd class="col-sm-9">
              <% if (r.site) { %>
                #<%= r.site.number %> · <%= r.site.type %> · max <%= r.site.lengthFt %> ft
              <% } else { %>
                Site ID <%= r.siteId %>
              <% } %>
            </dd>

            <dt class="col-sm-3">Dates</dt>
			<dd class="col-sm-9">
              <%= r.checkIn %>
              &rarr;
              <%= r.checkOut %>
            </dd>

            <dt class="col-sm-3">Rig length</dt>
            <dd class="col-sm-9"><%= r.rigLengthFt %> ft</dd>

            <dt class="col-sm-3">Nightly rate</dt>
            <dd class="col-sm-9">$<%= Number(r.nightlyRate || 0).toFixed(2) %></dd>

            <dt class="col-sm-3">Total charged</dt>
            <dd class="col-sm-9">$<%= Number(r.amountPaid || 0).toFixed(2) %></dd>

            <dt class="col-sm-3">Status</dt>
            <dd class="col-sm-9"><%= r.status %></dd>
          </dl>
            <div class="d-flex justify-content-between gap-2 mt-4">
              <a href="/guest/dashboard" class="btn btn-secondary">Return to Dashboard</a>
              <a href="/reservations/<%= r.id %>/edit" class="btn btn-outline-primary">Edit reservation</a>
            </div>
        </div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
