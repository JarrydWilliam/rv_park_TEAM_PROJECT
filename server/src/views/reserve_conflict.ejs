<!doctype html>
<html lang="en">
  <head>
    <%- include('partials/head') %>
  </head>
  <body>
    <%- include('partials/nav') %>

    <header class="page-hero">
      <div class="container">
        <h1 class="display-6 fw-semibold mb-1">Site No Longer Available</h1>
        <p class="text-muted mb-0">
          Site <strong>#<%= site.number %></strong> is no longer available for
          <%= checkIn %> – <%= checkOut %>. Here are other options.
        </p>
      </div>
    </header>

    <main class="container py-4">
      <section class="card card-elevated mb-4">
        <div class="card-body">
          <div class="alert alert-warning mb-0">
            <i class="bi bi-exclamation-triangle me-2"></i>
            Another guest booked this site while you were filling the form.
            Please choose a different site below.
          </div>
        </div>
      </section>

      <% if (alternatives && alternatives.length) { %>
        <section class="card card-elevated">
          <div class="card-body">
            <h2 class="h5 mb-3">Available sites for <%= checkIn %> – <%= checkOut %></h2>

            <div class="table-responsive">
              <table class="table table-dark table-hover table-striped align-middle mb-0">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Type</th>
                    <th>Length (ft)</th>
                    <th>Status</th>
                    <th class="text-end">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <% alternatives.forEach(s => { %>
                    <tr>
                      <td class="fw-medium"><%= s.number %></td>
                      <td><%= s.type %></td>
                      <td><%= s.lengthFt %></td>
                      <td>
                        <span class="badge bg-success-subtle text-success-emphasis border border-success-subtle">
                          Available
                        </span>
                      </td>
                      <td class="text-end">
                        <form method="get" action="/reserve/new" class="d-inline">
                          <input type="hidden" name="siteId" value="<%= s.id %>">
                          <input type="hidden" name="check_in" value="<%= checkIn %>">
                          <input type="hidden" name="check_out" value="<%= checkOut %>">
                          <input type="hidden" name="rig_length" value="<%= rigLengthFt %>">
                          <input type="hidden" name="type" value="<%= type || '' %>">
                          <button type="submit" class="btn btn-sm btn-primary">
                            Reserve this site
                          </button>
                        </form>
                      </td>
                    </tr>
                  <% }); %>
                </tbody>
              </table>
            </div>
          </div>
        </section>
      <% } else { %>
        <p class="text-muted">
          No alternate sites are available for those dates. Try adjusting your dates or rig length.
        </p>
      <% } %>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
